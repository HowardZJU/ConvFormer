model_args: Namespace(data_dir='data', output_dir='output_tmp/YelpC30H256S2', data_name='Yelp', do_eval=False, full_sort=0, max_seq_length=50, model_name='CONV', hidden_size=256, num_hidden_layers=2, num_attention_heads=1, hidden_act='gelu', no_filter=False, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, lr=0.001, ablate=0, batch_size=256, drop_null=0, zero_pad=1, patience=10, seed=2, epochs=200, weight_decay=0.0, n_fft=50, local=3, pool_size=2, conv_name=1, initialize=1, padding_mode=0, conv_size=30, act=0, ffn_multiplier=4, trial='None', data_file='data/Yelp.txt', sample_file='data/Yelp_sample.txt', item_size=20034)
Total Parameters: 6211072
Train, Epoch:0, rec_loss:1231.5548
Val, Epoch:0, HIT@1:0.1051 HIT@5:0.3041 HIT@10:0.4448 NDCG@1:0.1051 NDCG@5:0.2056 NDCG@10:0.2509 MRR:0.2140
Train, Epoch:1, rec_loss:981.8437
Val, Epoch:1, HIT@1:0.1406 HIT@5:0.4057 HIT@10:0.5775 NDCG@1:0.1406 NDCG@5:0.2754 NDCG@10:0.3307 MRR:0.2764
Train, Epoch:2, rec_loss:808.7966
Val, Epoch:2, HIT@1:0.1640 HIT@5:0.4487 HIT@10:0.6319 NDCG@1:0.1640 NDCG@5:0.3089 NDCG@10:0.3680 MRR:0.3070
Train, Epoch:3, rec_loss:698.3623
Val, Epoch:3, HIT@1:0.1910 HIT@5:0.4956 HIT@10:0.6832 NDCG@1:0.1910 NDCG@5:0.3462 NDCG@10:0.4069 MRR:0.3396
Train, Epoch:4, rec_loss:614.2455
Val, Epoch:4, HIT@1:0.2108 HIT@5:0.5227 HIT@10:0.7067 NDCG@1:0.2108 NDCG@5:0.3694 NDCG@10:0.4289 MRR:0.3598
Train, Epoch:5, rec_loss:551.3705
Val, Epoch:5, HIT@1:0.2233 HIT@5:0.5448 HIT@10:0.7199 NDCG@1:0.2233 NDCG@5:0.3880 NDCG@10:0.4447 MRR:0.3753
Train, Epoch:6, rec_loss:504.6755
Val, Epoch:6, HIT@1:0.2294 HIT@5:0.5518 HIT@10:0.7294 NDCG@1:0.2294 NDCG@5:0.3958 NDCG@10:0.4533 MRR:0.3829
Train, Epoch:7, rec_loss:469.9859
Val, Epoch:7, HIT@1:0.2358 HIT@5:0.5626 HIT@10:0.7368 NDCG@1:0.2358 NDCG@5:0.4036 NDCG@10:0.4601 MRR:0.3888
Train, Epoch:8, rec_loss:438.2570
Val, Epoch:8, HIT@1:0.2405 HIT@5:0.5695 HIT@10:0.7428 NDCG@1:0.2405 NDCG@5:0.4097 NDCG@10:0.4658 MRR:0.3939
Train, Epoch:9, rec_loss:416.3406
Val, Epoch:9, HIT@1:0.2413 HIT@5:0.5746 HIT@10:0.7434 NDCG@1:0.2413 NDCG@5:0.4138 NDCG@10:0.4686 MRR:0.3971
Train, Epoch:10, rec_loss:400.5057
Val, Epoch:10, HIT@1:0.2432 HIT@5:0.5754 HIT@10:0.7455 NDCG@1:0.2432 NDCG@5:0.4153 NDCG@10:0.4705 MRR:0.3986
Train, Epoch:11, rec_loss:385.0720
Val, Epoch:11, HIT@1:0.2490 HIT@5:0.5843 HIT@10:0.7471 NDCG@1:0.2490 NDCG@5:0.4221 NDCG@10:0.4750 MRR:0.4036
Train, Epoch:12, rec_loss:371.9783
Val, Epoch:12, HIT@1:0.2449 HIT@5:0.5810 HIT@10:0.7455 NDCG@1:0.2449 NDCG@5:0.4187 NDCG@10:0.4721 MRR:0.4003
Train, Epoch:13, rec_loss:362.9319
Val, Epoch:13, HIT@1:0.2519 HIT@5:0.5901 HIT@10:0.7508 NDCG@1:0.2519 NDCG@5:0.4266 NDCG@10:0.4787 MRR:0.4069
Train, Epoch:14, rec_loss:350.3052
Val, Epoch:14, HIT@1:0.2535 HIT@5:0.5890 HIT@10:0.7512 NDCG@1:0.2535 NDCG@5:0.4271 NDCG@10:0.4798 MRR:0.4081
Train, Epoch:15, rec_loss:338.9536
Val, Epoch:15, HIT@1:0.2572 HIT@5:0.5921 HIT@10:0.7504 NDCG@1:0.2572 NDCG@5:0.4301 NDCG@10:0.4814 MRR:0.4105
Train, Epoch:16, rec_loss:336.3451
Val, Epoch:16, HIT@1:0.2585 HIT@5:0.5891 HIT@10:0.7466 NDCG@1:0.2585 NDCG@5:0.4297 NDCG@10:0.4808 MRR:0.4110
Train, Epoch:17, rec_loss:327.8862
Val, Epoch:17, HIT@1:0.2582 HIT@5:0.5890 HIT@10:0.7475 NDCG@1:0.2582 NDCG@5:0.4300 NDCG@10:0.4814 MRR:0.4115
Train, Epoch:18, rec_loss:323.7033
Val, Epoch:18, HIT@1:0.2634 HIT@5:0.5955 HIT@10:0.7500 NDCG@1:0.2634 NDCG@5:0.4353 NDCG@10:0.4854 MRR:0.4157
Train, Epoch:19, rec_loss:315.4739
Val, Epoch:19, HIT@1:0.2630 HIT@5:0.5941 HIT@10:0.7482 NDCG@1:0.2630 NDCG@5:0.4342 NDCG@10:0.4843 MRR:0.4148
Train, Epoch:20, rec_loss:313.7689
Val, Epoch:20, HIT@1:0.2636 HIT@5:0.5933 HIT@10:0.7479 NDCG@1:0.2636 NDCG@5:0.4344 NDCG@10:0.4847 MRR:0.4153
Train, Epoch:21, rec_loss:307.8673
Val, Epoch:21, HIT@1:0.2661 HIT@5:0.5970 HIT@10:0.7490 NDCG@1:0.2661 NDCG@5:0.4372 NDCG@10:0.4866 MRR:0.4174
Train, Epoch:22, rec_loss:304.7315
Val, Epoch:22, HIT@1:0.2668 HIT@5:0.5961 HIT@10:0.7448 NDCG@1:0.2668 NDCG@5:0.4375 NDCG@10:0.4859 MRR:0.4177
Train, Epoch:23, rec_loss:301.9077
Val, Epoch:23, HIT@1:0.2666 HIT@5:0.5997 HIT@10:0.7491 NDCG@1:0.2666 NDCG@5:0.4394 NDCG@10:0.4880 MRR:0.4189
Train, Epoch:24, rec_loss:295.0751
Val, Epoch:24, HIT@1:0.2658 HIT@5:0.5978 HIT@10:0.7495 NDCG@1:0.2658 NDCG@5:0.4380 NDCG@10:0.4872 MRR:0.4178
Train, Epoch:25, rec_loss:292.7125
Val, Epoch:25, HIT@1:0.2664 HIT@5:0.5963 HIT@10:0.7464 NDCG@1:0.2664 NDCG@5:0.4375 NDCG@10:0.4862 MRR:0.4176
Train, Epoch:26, rec_loss:287.5418
Val, Epoch:26, HIT@1:0.2666 HIT@5:0.5972 HIT@10:0.7457 NDCG@1:0.2666 NDCG@5:0.4384 NDCG@10:0.4866 MRR:0.4184
Train, Epoch:27, rec_loss:286.0221
Val, Epoch:27, HIT@1:0.2657 HIT@5:0.5959 HIT@10:0.7480 NDCG@1:0.2657 NDCG@5:0.4368 NDCG@10:0.4861 MRR:0.4168
Train, Epoch:28, rec_loss:282.2647
Val, Epoch:28, HIT@1:0.2673 HIT@5:0.5972 HIT@10:0.7464 NDCG@1:0.2673 NDCG@5:0.4385 NDCG@10:0.4870 MRR:0.4186
Train, Epoch:29, rec_loss:280.5085
Val, Epoch:29, HIT@1:0.2666 HIT@5:0.5939 HIT@10:0.7433 NDCG@1:0.2666 NDCG@5:0.4371 NDCG@10:0.4856 MRR:0.4176
Train, Epoch:30, rec_loss:280.0503
Val, Epoch:30, HIT@1:0.2694 HIT@5:0.6006 HIT@10:0.7470 NDCG@1:0.2694 NDCG@5:0.4410 NDCG@10:0.4885 MRR:0.4202
Train, Epoch:31, rec_loss:274.6442
Val, Epoch:31, HIT@1:0.2695 HIT@5:0.5995 HIT@10:0.7483 NDCG@1:0.2695 NDCG@5:0.4409 NDCG@10:0.4892 MRR:0.4206
Train, Epoch:32, rec_loss:276.7733
Val, Epoch:32, HIT@1:0.2724 HIT@5:0.5987 HIT@10:0.7463 NDCG@1:0.2724 NDCG@5:0.4417 NDCG@10:0.4895 MRR:0.4218
Train, Epoch:33, rec_loss:269.3565
Val, Epoch:33, HIT@1:0.2720 HIT@5:0.5995 HIT@10:0.7469 NDCG@1:0.2720 NDCG@5:0.4416 NDCG@10:0.4895 MRR:0.4215
Train, Epoch:34, rec_loss:269.3424
Val, Epoch:34, HIT@1:0.2746 HIT@5:0.5998 HIT@10:0.7476 NDCG@1:0.2746 NDCG@5:0.4434 NDCG@10:0.4914 MRR:0.4238
Train, Epoch:35, rec_loss:268.4253
Val, Epoch:35, HIT@1:0.2724 HIT@5:0.5987 HIT@10:0.7458 NDCG@1:0.2724 NDCG@5:0.4424 NDCG@10:0.4902 MRR:0.4227
Train, Epoch:36, rec_loss:265.6839
Val, Epoch:36, HIT@1:0.2759 HIT@5:0.5999 HIT@10:0.7453 NDCG@1:0.2759 NDCG@5:0.4438 NDCG@10:0.4910 MRR:0.4240
Train, Epoch:37, rec_loss:261.5821
Val, Epoch:37, HIT@1:0.2740 HIT@5:0.5997 HIT@10:0.7452 NDCG@1:0.2740 NDCG@5:0.4436 NDCG@10:0.4909 MRR:0.4239
Train, Epoch:38, rec_loss:260.7397
Val, Epoch:38, HIT@1:0.2712 HIT@5:0.5971 HIT@10:0.7436 NDCG@1:0.2712 NDCG@5:0.4408 NDCG@10:0.4884 MRR:0.4211
Train, Epoch:39, rec_loss:257.9288
Val, Epoch:39, HIT@1:0.2739 HIT@5:0.6021 HIT@10:0.7458 NDCG@1:0.2739 NDCG@5:0.4446 NDCG@10:0.4912 MRR:0.4239
Train, Epoch:40, rec_loss:260.1823
Val, Epoch:40, HIT@1:0.2746 HIT@5:0.6004 HIT@10:0.7436 NDCG@1:0.2746 NDCG@5:0.4445 NDCG@10:0.4909 MRR:0.4243
Train, Epoch:41, rec_loss:255.8017
Val, Epoch:41, HIT@1:0.2749 HIT@5:0.6021 HIT@10:0.7416 NDCG@1:0.2749 NDCG@5:0.4447 NDCG@10:0.4900 MRR:0.4238
Train, Epoch:42, rec_loss:253.1748
Val, Epoch:42, HIT@1:0.2738 HIT@5:0.5983 HIT@10:0.7420 NDCG@1:0.2738 NDCG@5:0.4427 NDCG@10:0.4893 MRR:0.4228
Train, Epoch:43, rec_loss:254.9813
Val, Epoch:43, HIT@1:0.2749 HIT@5:0.6028 HIT@10:0.7442 NDCG@1:0.2749 NDCG@5:0.4453 NDCG@10:0.4912 MRR:0.4245
Train, Epoch:44, rec_loss:251.8650
Val, Epoch:44, HIT@1:0.2745 HIT@5:0.6001 HIT@10:0.7435 NDCG@1:0.2745 NDCG@5:0.4442 NDCG@10:0.4908 MRR:0.4241
Train, Epoch:45, rec_loss:249.1708
Val, Epoch:45, HIT@1:0.2739 HIT@5:0.5986 HIT@10:0.7436 NDCG@1:0.2739 NDCG@5:0.4430 NDCG@10:0.4901 MRR:0.4231
Train, Epoch:46, rec_loss:249.7257
Val, Epoch:46, HIT@1:0.2754 HIT@5:0.5974 HIT@10:0.7444 NDCG@1:0.2754 NDCG@5:0.4429 NDCG@10:0.4906 MRR:0.4235
Train, Epoch:47, rec_loss:248.8411
Val, Epoch:47, HIT@1:0.2736 HIT@5:0.5993 HIT@10:0.7431 NDCG@1:0.2736 NDCG@5:0.4431 NDCG@10:0.4898 MRR:0.4230
Train, Epoch:48, rec_loss:246.7585
Val, Epoch:48, HIT@1:0.2765 HIT@5:0.6004 HIT@10:0.7434 NDCG@1:0.2765 NDCG@5:0.4451 NDCG@10:0.4915 MRR:0.4251
Train, Epoch:49, rec_loss:244.8589
Val, Epoch:49, HIT@1:0.2755 HIT@5:0.6023 HIT@10:0.7437 NDCG@1:0.2755 NDCG@5:0.4451 NDCG@10:0.4910 MRR:0.4244
Train, Epoch:50, rec_loss:244.6681
Val, Epoch:50, HIT@1:0.2745 HIT@5:0.6025 HIT@10:0.7433 NDCG@1:0.2745 NDCG@5:0.4451 NDCG@10:0.4910 MRR:0.4243
Train, Epoch:51, rec_loss:243.0711
Val, Epoch:51, HIT@1:0.2740 HIT@5:0.6020 HIT@10:0.7428 NDCG@1:0.2740 NDCG@5:0.4449 NDCG@10:0.4906 MRR:0.4240
Train, Epoch:52, rec_loss:241.5934
Val, Epoch:52, HIT@1:0.2774 HIT@5:0.6051 HIT@10:0.7443 NDCG@1:0.2774 NDCG@5:0.4480 NDCG@10:0.4932 MRR:0.4271
Train, Epoch:53, rec_loss:240.3190
Val, Epoch:53, HIT@1:0.2763 HIT@5:0.6007 HIT@10:0.7414 NDCG@1:0.2763 NDCG@5:0.4448 NDCG@10:0.4905 MRR:0.4243
Train, Epoch:54, rec_loss:240.4460
Val, Epoch:54, HIT@1:0.2778 HIT@5:0.6008 HIT@10:0.7409 NDCG@1:0.2778 NDCG@5:0.4457 NDCG@10:0.4912 MRR:0.4255
Train, Epoch:55, rec_loss:239.1152
Val, Epoch:55, HIT@1:0.2766 HIT@5:0.6015 HIT@10:0.7449 NDCG@1:0.2766 NDCG@5:0.4461 NDCG@10:0.4928 MRR:0.4260
Train, Epoch:56, rec_loss:235.5519
Val, Epoch:56, HIT@1:0.2770 HIT@5:0.6020 HIT@10:0.7416 NDCG@1:0.2770 NDCG@5:0.4467 NDCG@10:0.4919 MRR:0.4261
Train, Epoch:57, rec_loss:237.9486
Val, Epoch:57, HIT@1:0.2764 HIT@5:0.6023 HIT@10:0.7443 NDCG@1:0.2764 NDCG@5:0.4460 NDCG@10:0.4920 MRR:0.4253
Train, Epoch:58, rec_loss:235.2547
Val, Epoch:58, HIT@1:0.2773 HIT@5:0.6039 HIT@10:0.7437 NDCG@1:0.2773 NDCG@5:0.4478 NDCG@10:0.4932 MRR:0.4270
Train, Epoch:59, rec_loss:237.7012
Val, Epoch:59, HIT@1:0.2782 HIT@5:0.6027 HIT@10:0.7439 NDCG@1:0.2782 NDCG@5:0.4471 NDCG@10:0.4930 MRR:0.4268
Train, Epoch:60, rec_loss:236.0151
Val, Epoch:60, HIT@1:0.2768 HIT@5:0.6021 HIT@10:0.7426 NDCG@1:0.2768 NDCG@5:0.4461 NDCG@10:0.4918 MRR:0.4256
Train, Epoch:61, rec_loss:232.6871
Val, Epoch:61, HIT@1:0.2784 HIT@5:0.6016 HIT@10:0.7426 NDCG@1:0.2784 NDCG@5:0.4467 NDCG@10:0.4925 MRR:0.4266
Train, Epoch:62, rec_loss:234.4877
Val, Epoch:62, HIT@1:0.2754 HIT@5:0.5986 HIT@10:0.7374 NDCG@1:0.2754 NDCG@5:0.4441 NDCG@10:0.4893 MRR:0.4241
Test, Epoch:0, HIT@1:0.2732 HIT@5:0.5953 HIT@10:0.7448 NDCG@1:0.2732 NDCG@5:0.4409 NDCG@10:0.4894 MRR:0.4221
